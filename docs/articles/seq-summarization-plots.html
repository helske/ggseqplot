<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ggseqplot">
<title>Sequence Summarization Plots • ggseqplot</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Poppins-0.4.1/font.css" rel="stylesheet">
<link href="../deps/_Fira%20Code-0.4.1/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sequence Summarization Plots">
<meta property="og:description" content="ggseqplot">
<meta property="og:image" content="https://maraab23.github.io/ggseqplot/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ggseqplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/seq-representation-plots.html">Sequence Representation Plots</a>
    <a class="dropdown-item" href="../articles/seq-summarization-plots.html">Sequence Summarization Plots</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/maraab23/ggseqplot/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sequence Summarization Plots</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/maraab23/ggseqplot/blob/HEAD/vignettes/seq-summarization-plots.Rmd" class="external-link"><code>vignettes/seq-summarization-plots.Rmd</code></a></small>
      <div class="d-none name"><code>seq-summarization-plots.Rmd</code></div>
    </div>

    
    
<p>Following Fasang and Liao <span class="citation">(2014)</span>, we
distinguish between sequence representation and summarization graphs.
The latter aggregate and summarize the information stored in the
sequence data without plotting actual observed sequences. Given the
complexity of sequence data, theses type of plots focus on one or two
dimensions of information stored in sequence data <span class="citation">(Brzinsky-Fay, 2014)</span>. Among the diverse members
of the family of summarization graphs are sequence transitions plot,
Kaplan-Meier survival curves, modal state plots, mean time plots, state
distribution plots, and entropy plots <span class="citation">(Fasang
&amp; Liao, 2014; Raab &amp; Struffolino, 2022)</span>.</p>
<p>Currently, <a href="https://github.com/maraab23/ggseqplot" class="external-link">ggseqplot</a> includes three summarization
graphs:</p>
<ul>
<li>state distribution plots (<code>ggseqdplot</code>)</li>
<li>entropy line plots (<code>ggseqplot</code>)</li>
<li>transition rate plots (<code>ggseqtrplot</code>)</li>
</ul>
<p><a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a> and <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineRextras}</code></a> provide a much more
comprehensive set of plots. Although, {ggseqplot} does not aim at
rebuilding all of these plots it’s planned to add additional plot
types.</p>
<p>This vignette outlines how sequence data generated with
<code><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">TraMineR::seqdef</a></code> are reshaped to plot them as ggplot2-typed
figures using {ggseqplot}. We compare the resulting plots to those
produced by <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a> where applicable.</p>
<p>Note, that this library was not written because I personally dislike
the plots produced by <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a>, but rather because I am
normally using <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> instead of base R’s
<code>plot</code> environment for visualizing data. <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a> <span class="citation">(Gabadinho et al., 2011)</span> was developed before <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> <span class="citation">(Wickham, 2016)</span> was as popular as it is today
and back then many users were more familiar with coding base R plots. To
date, however, many researchers and students are more accustomed to
using <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> and prefer to draw on the
related skills and experiences instead of learning how to refine base R
plots just for the single purpose of visualizing sequence data.</p>
<div class="section level2">
<h2 id="setup-example">Setup example<a class="anchor" aria-label="anchor" href="#setup-example"></a>
</h2>
<p>We start by loading the required libraries and defining the sequence
data to be plotted. We draw in the examples from the <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a> for setting up the
examples.</p>
<p> </p>
<details><summary><strong>Click to see code for installing and loading required
packages</strong>
</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># Load and download (if necessary) required packages ----</span>
<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>


<span class="co"># Save package names as a vector of strings</span>
<span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"colorspace"</span>, <span class="st">"ggplot2"</span>, <span class="st">"ggthemes"</span>, <span class="st">"hrbrthemes"</span>, 
          <span class="st">"patchwork"</span>, <span class="st">"TraMineR"</span>, <span class="st">"TraMineRextras"</span><span class="op">)</span>


<span class="co"># Install uninstalled packages</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">pkgs</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">pkgs</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, 
       <span class="va">install.packages</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"repos"</span><span class="op">)</span><span class="op">[</span><span class="st">"CRAN"</span><span class="op">]</span><span class="op">)</span>


<span class="co"># Load all packages to library and adjust options</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">pkgs</span>, <span class="va">library</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Don't forget to load ggseqplot</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/maraab23/ggseqplot" class="external-link">ggseqplot</a></span><span class="op">)</span></code></pre></div>
</details><p> </p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="co"># Creating state sequence objects from example data sets ----</span>
<span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>

<span class="co"># biofam data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">biofam</span><span class="op">)</span>

<span class="va">biofam.lab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Parent"</span>, <span class="st">"Left"</span>, <span class="st">"Married"</span>, <span class="st">"Left+Marr"</span>,
                <span class="st">"Child"</span>, <span class="st">"Left+Child"</span>, <span class="st">"Left+Marr+Child"</span>, <span class="st">"Divorced"</span><span class="op">)</span>

<span class="va">biofam.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">biofam</span>, <span class="fl">10</span><span class="op">:</span><span class="fl">25</span>, 
                     labels <span class="op">=</span> <span class="va">biofam.lab</span>,
                     weights <span class="op">=</span> <span class="va">biofam</span><span class="op">$</span><span class="va">wp00tbgs</span><span class="op">)</span>

<span class="co">## actcal data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">actcal</span><span class="op">)</span>

<span class="va">actcal.lab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"&gt; 37 hours"</span>, <span class="st">"19-36 hours"</span>, <span class="st">"1-18 hours"</span>, <span class="st">"no work"</span><span class="op">)</span>

<span class="va">actcal.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">actcal</span>,<span class="fl">13</span><span class="op">:</span><span class="fl">24</span>,
                     labels<span class="op">=</span><span class="va">actcal.lab</span><span class="op">)</span>

<span class="co">## ex1 data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">)</span>
<span class="va">ex1.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">ex1</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">13</span>, 
                  weights<span class="op">=</span><span class="va">ex1</span><span class="op">$</span><span class="va">weights</span><span class="op">)</span></code></pre></div>
<p>Note that the default figure size in this document is specified
as:</p>
<blockquote>
<p>fig.width=8, fig.height=6</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="state-distribution-plots">State distribution plots<a class="anchor" aria-label="anchor" href="#state-distribution-plots"></a>
</h2>
<div class="section level3">
<h3 id="technicalities">Technicalities<a class="anchor" aria-label="anchor" href="#technicalities"></a>
</h3>
<p>Under the hood <code>ggseqdplot</code> calls
<code><a href="https://rdrr.io/pkg/TraMineR/man/seqstatd.html" class="external-link">TraMineR::seqstatd</a></code> to obtain the cross-sectional state
distributions across the positions of the sequence data. These
distributional data are reshaped into a long data set in which every row
stores the (weighted) relative frequency of a given state at a given
position along the sequence. The example data <code>actcal.seq</code>,
for instance, contain sequences of length 12 with an alphabet comprising
4 states. The reshaped data serving as source for the
<code>ggplot</code> thus contain <span class="math inline">\(12\times4=48\)</span> rows. If a group vector is
specified, the respective data will comprise 48 rows for each group. The
data set produced by <code>ggseqdplot</code> can be accessed if the
function’s output is assigned to an object. The resulting list object
stores the data as its first element (named <code>data</code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqdplot.html">ggseqdplot</a></span><span class="op">(</span><span class="va">actcal.seq</span><span class="op">)</span>
<span class="va">dplot</span><span class="op">$</span><span class="va">data</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 48 x 6</span></span>
<span class="co">#&gt;    group state      k     x     value grouplab           </span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;glue&gt;</span>             </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 &gt; 37 hours jan00 1     0.421 Rel. Freq. (n=2000)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1 &gt; 37 hours feb00 2     0.420 Rel. Freq. (n=2000)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1 &gt; 37 hours mar00 3     0.422 Rel. Freq. (n=2000)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1 &gt; 37 hours apr00 4     0.418 Rel. Freq. (n=2000)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1 &gt; 37 hours may00 5     0.420 Rel. Freq. (n=2000)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1 &gt; 37 hours jun00 6     0.42  Rel. Freq. (n=2000)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1 &gt; 37 hours jul00 7     0.422 Rel. Freq. (n=2000)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1 &gt; 37 hours aug00 8     0.420 Rel. Freq. (n=2000)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1 &gt; 37 hours sep00 9     0.418 Rel. Freq. (n=2000)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1 &gt; 37 hours oct00 10    0.418 Rel. Freq. (n=2000)</span>
<span class="co">#&gt; <span style="color: #949494;"># ... with 38 more rows</span></span></code></pre></div>
<p>Once the data are in the right shape <code>ggseqdplot</code> renders
stacked bar charts for each sequence position using
<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_bar</a></code>.</p>
</div>
<div class="section level3">
<h3 id="baseline-comparison">Baseline comparison<a class="anchor" aria-label="anchor" href="#baseline-comparison"></a>
</h3>
<p>We start with the most basic version of the function simply plotting
the state distributions of <code>actcal.seq</code> without changing any
of the defaults. Despite a few layout differences both produce pretty
similar results.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># TraMineR::seqplot</span>
<span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqdplot</a></span><span class="op">(</span><span class="va">actcal.seq</span><span class="op">)</span></code></pre></div>
<p><img src="seq-summarization-plots_files/figure-html/dplot1-1.png" width="768"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># ggseqplot::ggseqdplot</span>
<span class="fu"><a href="../reference/ggseqdplot.html">ggseqdplot</a></span><span class="op">(</span><span class="va">actcal.seq</span><span class="op">)</span></code></pre></div>
<p><img src="seq-summarization-plots_files/figure-html/dplot1-2.png" width="768"></p>
<p>This similarity prevails also when we add some complexity by
visualizing the state distributions by gender.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># TraMineR::seqplot</span>
<span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqdplot</a></span><span class="op">(</span><span class="va">actcal.seq</span>, group<span class="op">=</span><span class="va">actcal</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></code></pre></div>
<p><img src="seq-summarization-plots_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># ggseqplot::ggseqdplot</span>
<span class="fu"><a href="../reference/ggseqdplot.html">ggseqdplot</a></span><span class="op">(</span><span class="va">actcal.seq</span>, group<span class="op">=</span><span class="va">actcal</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></code></pre></div>
<p><img src="seq-summarization-plots_files/figure-html/unnamed-chunk-3-2.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="utilizing-ggplot2-environment">Utilizing ggplot2 environment<a class="anchor" aria-label="anchor" href="#utilizing-ggplot2-environment"></a>
</h3>
<p>We proceed by illustrating how <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> functions &amp; extensions
can be used to refine the default outcome. Just like every other <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> figure the appearance of
plots generated with <code>ggseqplot</code> functions can be
dramatically changed with a few adjustments:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggseqdplot.html">ggseqdplot</a></span><span class="op">(</span><span class="va">actcal.seq</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_fill_discrete_sequential</span><span class="op">(</span><span class="st">"heat"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"State distribution plot"</span>,
       x <span class="op">=</span> <span class="st">"Month"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Alphabet"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_ipsum</span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="co"># ensures that this works on different OS</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">30</span>, 
                                  margin<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">20</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
        plot.title.position <span class="op">=</span> <span class="st">"plot"</span><span class="op">)</span></code></pre></div>
<p><img src="seq-summarization-plots_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<p>In the following example we again illustrate a few <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> functions &amp; extensions by
composing a figure comprising two plots produced with
<code>ggseqdplot</code>. Both visualize the same data but only the first
plot considers weights. In addition to state distributions the plots
display the accompanying entropies as line plot
(<code>geom_line</code>). Finally, the plots are brought together using
the <a href="https://patchwork.data-imaginist.com/index.html" class="external-link"><code>{patchwork}</code></a>
library <span class="citation">(Pedersen, 2020)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Save plot using weights</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqdplot.html">ggseqdplot</a></span><span class="op">(</span><span class="va">ex1.seq</span>, 
                 with.entropy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Weighted data"</span><span class="op">)</span>

<span class="co"># Save same plot without using weights</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqdplot.html">ggseqdplot</a></span><span class="op">(</span><span class="va">ex1.seq</span>, 
                 with.entropy <span class="op">=</span> <span class="cn">TRUE</span>,
                 weighted <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Unweighted data"</span><span class="op">)</span>

<span class="co"># Arrange and refine plots using patchwork</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> 
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span> <span class="op">&amp;</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span> <span class="va">canva_palettes</span><span class="op">$</span><span class="va">`Fun and tropical`</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span>
  <span class="fu">theme_ipsum</span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">&amp;</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>,
                                  hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,
        legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="seq-summarization-plots_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="entropy-plots">Entropy plots<a class="anchor" aria-label="anchor" href="#entropy-plots"></a>
</h2>
</div>
<div class="section level2">
<h2 id="transition-rate-plots">Transition rate plots<a class="anchor" aria-label="anchor" href="#transition-rate-plots"></a>
</h2>
<div class="section level3">
<h3 id="technicalities-1">Technicalities<a class="anchor" aria-label="anchor" href="#technicalities-1"></a>
</h3>
<p><code>ggseqdplot</code> calls <code><a href="https://rdrr.io/pkg/TraMineR/man/seqtrate.html" class="external-link">TraMineR::seqtrate</a></code> to
obtain the transition rates between the states of the alphabet.
<code><a href="https://rdrr.io/pkg/TraMineR/man/seqtrate.html" class="external-link">TraMineR::seqtrate</a></code> stores these rates in a symmetrical
matrix which internally is reshaped into a long format with one row for
every combination of states (i.e., the squared size of the sequence
alphabet) by <code>ggseqdplot</code>. The reshaped data are the input
for a <code>ggplot</code> call using <code>geom_tile</code>.</p>
<p>The data set produced by <code>ggseqtrplot</code> can be accessed if
the function’s output is assigned to an object. The resulting list
object stores the data as its first element (named
<code>data</code>)</p>
</div>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<p>We start with a simple example that only takes the sequence data and
the group argument as inputs. The output is a faceted plot visualizing
two transition rate matrices of DSS sequence data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggseqtrplot.html">ggseqtrplot</a></span><span class="op">(</span><span class="va">actcal.seq</span>, 
            group <span class="op">=</span> <span class="va">actcal</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span>
<span class="co">#&gt;  [&gt;] computing transition probabilities for states A/B/C/D ...</span>
<span class="co">#&gt;  [&gt;] computing transition probabilities for states A/B/C/D ...</span></code></pre></div>
<p><img src="seq-summarization-plots_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<p>In the second example we specify additional arguments and utilize
once again the <code>patchwork</code> library to compose a figure that
compares the transition matrices of sequence stored in the STS and the
DSS format.</p>
<p>We use <code>x_n.dodge = 2</code> to prevent overlapping of the state
labels of the x-axis, slightly reduce the labels size of the value
labels displayed within the tiles, and use <code>dss = FALSE</code> to
compute and display the transition rates of the STS sequences.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqtrplot.html">ggseqtrplot</a></span><span class="op">(</span><span class="va">biofam.seq</span>, 
                  dss <span class="op">=</span> <span class="cn">FALSE</span>, 
                  x_n.dodge <span class="op">=</span> <span class="fl">2</span>,
                  labsize <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"STS Sequences"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>, <span class="st">"points"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  [&gt;] computing transition probabilities for states 0/1/2/3/4/5/6/7 ...</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqtrplot.html">ggseqtrplot</a></span><span class="op">(</span><span class="va">biofam.seq</span>, 
                  x_n.dodge <span class="op">=</span> <span class="fl">2</span>,
                  labsize <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"DSS Sequences"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">10</span><span class="op">)</span>, <span class="st">"points"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  [&gt;] computing transition probabilities for states 0/1/2/3/4/5/6/7 ...</span>

<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">&amp;</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>,
                                  hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="seq-summarization-plots_files/figure-html/unnamed-chunk-7-1.png" width="768"></p>
<p>Other than the grouped version of the plot this composed figure
contains the y-axis title and labels twice. This can be changed with
small adjustments of the corresponding <code>theme</code> arguments.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p2</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, 
        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">&amp;</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>,
                                  hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="seq-summarization-plots_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<hr>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-brzinsky-fay2014" class="csl-entry">
Brzinsky-Fay, C. (2014). <em>Graphical Representation of Transitions and
Sequences</em> (P. Blanchard, F. Bühlmann, &amp; J.-A. Gauthier, Eds.;
pp. 265–284). Springer. <a href="https://doi.org/10.1007/978-3-319-04969-4_14" class="external-link">https://doi.org/10.1007/978-3-319-04969-4_14</a>
</div>
<div id="ref-fasang2014" class="csl-entry">
Fasang, A. E., &amp; Liao, T. F. (2014). Visualizing Sequences in the
Social Sciences: Relative Frequency Sequence Plots. <em>Sociological
Methods &amp; Research</em>, <em>43</em>(4), 643–676. <a href="https://doi.org/10.1177/0049124113506563" class="external-link">https://doi.org/10.1177/0049124113506563</a>
</div>
<div id="ref-gabadinho2011" class="csl-entry">
Gabadinho, A., Ritschard, G., Müller, N. S., &amp; Studer, M. (2011).
Analyzing and Visualizing State Sequences in R with TraMineR.
<em>Journal of Statistical Software</em>, <em>40</em>(4), 1–37. <a href="https://doi.org/10.18637/jss.v040.i04" class="external-link">https://doi.org/10.18637/jss.v040.i04</a>
</div>
<div id="ref-pedersen2020" class="csl-entry">
Pedersen, T. L. (2020). <em>Patchwork: The composer of plots</em>. <a href="https://CRAN.R-project.org/package=patchwork" class="external-link">https://CRAN.R-project.org/package=patchwork</a>
</div>
<div id="ref-raab2022" class="csl-entry">
Raab, M., &amp; Struffolino, E. (2022). <em>Sequence analysis</em> (Vol.
190). SAGE. <a href="https://sa-book.github.io/" class="external-link">https://sa-book.github.io/</a>
</div>
<div id="ref-wickham2016" class="csl-entry">
Wickham, H. (2016). <em>ggplot2: Elegant graphics for data analysis</em>
(2nd ed. 2016). Springer. <a href="https://doi.org/10.1007/978-3-319-24277-4" class="external-link">https://doi.org/10.1007/978-3-319-24277-4</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Marcel Raab.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
